---
title: "Public API v1"
description: "Use API keys to talk to characters outside Discord."
---

## Base URL

`https://api.verba.ink`

## Quick start

<Steps>
  <Step title="Create an API key">
    Go to Verba <strong>Settings -&gt; Security -&gt; API Keys</strong> and create a key.
  </Step>
  <Step title="Pick a character">
    Use your character vanity slug or vanity URL (for example `mycharacter_abc` or `https://verba.ink/v/mycharacter_abc`).
  </Step>
  <Step title="Call an endpoint">
    Use `POST /v1/response` for text replies, or `POST /v1/image` for image generation.
  </Step>
</Steps>

## Authentication

Send your API key in either header:

- `Authorization: Bearer vka_...`
- `x-api-key: vka_...`

If no key is provided, or the key is invalid/revoked, the API returns `401`.

## Character identifier

Both endpoints use `character` (not `verb_id`).

Accepted formats:

- Vanity slug: `mycharacter_abc`
- Vanity path: `/v/mycharacter_abc`
- Full vanity URL: `https://verba.ink/v/mycharacter_abc`

## Endpoints

- `POST /v1/response` for text chat completions
- `POST /v1/image` for image generation

## POST `/v1/response`

Text-only completion endpoint.

<Note>
  `stream` is not supported in v1. If sent, it must be `false`.
</Note>

Required:

- `character` string (vanity URL or vanity slug)
- `messages` array

Optional:

- `session_id` string
- `temperature` number (`0..2`)
- `top_p` number (`0..1`)
- `max_tokens` number
- `stream` boolean (`false` only)

### Request examples

<CodeGroup>
```bash cURL
curl https://api.verba.ink/v1/response \
  -X POST \
  -H "Authorization: Bearer $VERBA_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "character": "mycharacter_abc",
    "messages": [
      { "role": "user", "content": "Tell me a short story about space pirates." }
    ],
    "stream": false
  }'
```

```javascript Node.js
const response = await fetch("https://api.verba.ink/v1/response", {
  method: "POST",
  headers: {
    "Authorization": `Bearer ${process.env.VERBA_API_KEY}`,
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    character: "mycharacter_abc",
    messages: [
      { role: "user", content: "Tell me a short story about space pirates." }
    ],
    stream: false
  })
});

const data = await response.json();
console.log(data);
```

```python Python
import os
import requests

response = requests.post(
    "https://api.verba.ink/v1/response",
    headers={
        "Authorization": f"Bearer {os.environ['VERBA_API_KEY']}",
        "Content-Type": "application/json",
    },
    json={
        "character": "mycharacter_abc",
        "messages": [
            {"role": "user", "content": "Tell me a short story about space pirates."}
        ],
        "stream": False,
    },
    timeout=60,
)

print(response.status_code)
print(response.json())
```

```powershell PowerShell
$headers = @{
  Authorization = "Bearer $env:VERBA_API_KEY"
  "Content-Type" = "application/json"
}

$body = @{
  character = "mycharacter_abc"
  messages = @(
    @{
      role = "user"
      content = "Tell me a short story about space pirates."
    }
  )
  stream = $false
} | ConvertTo-Json -Depth 10

Invoke-RestMethod `
  -Method Post `
  -Uri "https://api.verba.ink/v1/response" `
  -Headers $headers `
  -Body $body
```
</CodeGroup>

### Example response

```json
{
  "id": "chatcmpl_...",
  "object": "chat.completion",
  "created": 1739730000,
  "model": "m_free_a",
  "character": "mycharacter_abc",
  "session_id": "sess_...",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "..."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 0,
    "completion_tokens": 0,
    "total_tokens": 0
  }
}
```

## POST `/v1/image`

Generates one image URL.

Required:

- `character` string (vanity URL or vanity slug)
- `prompt` string

Optional:

- `session_id` string
- `image_urls` string array (reference images)
- `size` (`1024x1024` only)
- `response_format` (`url` only)

### Request examples

<CodeGroup>
```bash cURL
curl https://api.verba.ink/v1/image \
  -X POST \
  -H "Authorization: Bearer $VERBA_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "character": "mycharacter_abc",
    "prompt": "A cinematic portrait of a cyberpunk fox detective",
    "size": "1024x1024",
    "response_format": "url"
  }'
```

```javascript Node.js
const response = await fetch("https://api.verba.ink/v1/image", {
  method: "POST",
  headers: {
    "Authorization": `Bearer ${process.env.VERBA_API_KEY}`,
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
    character: "mycharacter_abc",
    prompt: "A cinematic portrait of a cyberpunk fox detective",
    size: "1024x1024",
    response_format: "url"
  })
});

const data = await response.json();
console.log(data);
```

```python Python
import os
import requests

response = requests.post(
    "https://api.verba.ink/v1/image",
    headers={
        "Authorization": f"Bearer {os.environ['VERBA_API_KEY']}",
        "Content-Type": "application/json",
    },
    json={
        "character": "mycharacter_abc",
        "prompt": "A cinematic portrait of a cyberpunk fox detective",
        "size": "1024x1024",
        "response_format": "url",
    },
    timeout=120,
)

print(response.status_code)
print(response.json())
```

```powershell PowerShell
$headers = @{
  Authorization = "Bearer $env:VERBA_API_KEY"
  "Content-Type" = "application/json"
}

$body = @{
  character = "mycharacter_abc"
  prompt = "A cinematic portrait of a cyberpunk fox detective"
  size = "1024x1024"
  response_format = "url"
} | ConvertTo-Json -Depth 10

Invoke-RestMethod `
  -Method Post `
  -Uri "https://api.verba.ink/v1/image" `
  -Headers $headers `
  -Body $body
```
</CodeGroup>

### Example response

```json
{
  "created": 1739730000,
  "character": "mycharacter_abc",
  "session_id": "sess_...",
  "model": "m_free_a",
  "revised_prompt": "A cinematic portrait of a cyberpunk fox detective",
  "data": [
    {
      "url": "https://api.verba.ink/uploads/generated-images/img_...png"
    }
  ]
}
```

## Sessions and memory

- `session_id` is optional.
- If omitted, Verba generates one and returns it.
- Reusing the same `session_id` preserves API conversation context for that caller + verb pair.
- API memory is stored in conversation history only (not DM or message logs).

## Access, billing, and limits

- API access is available to all users.
- Verb privacy still applies:
  - Private characters: owner only
  - Public characters: any API caller
- Billing and tier/model enforcement are applied to the **character owner account**.
- `/v1/*` uses account rate limits via the same per-user limiter model.

## Message format (`/v1/response`)

- `messages` must be an array.
- Include at least one `user` message.
- Allowed roles: `user`, `assistant`, `system` (`assistant` maps internally to model role).
- v1 response endpoint is text-only.

## Error model

Errors return JSON with a top-level `message` and an `error` object.

```json
{
  "message": "stream=true is not supported in v1",
  "error": {
    "message": "stream=true is not supported in v1",
    "type": "stream_not_supported",
    "code": "stream_not_supported"
  }
}
```

Common error cases:

- `401 invalid_api_key` for missing/invalid/revoked API key
- `403 verb_access_denied` for private character access by non-owner
- `400 stream_not_supported` when `stream` is not `false`
- `400 invalid_size` when `/v1/image` size is not `1024x1024`
